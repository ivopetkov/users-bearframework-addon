/*
 * Users addon for Bear Framework
 * https://github.com/ivopetkov/users-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{};
ivoPetkov.bearFrameworkAddons.users=ivoPetkov.bearFrameworkAddons.users||function(){var d=!1;return{currentUser:{exists:function(){return d}},initialize:function(b){d="undefined"!==typeof b?0<b:!1},login:function(b){clientShortcuts.get("lightbox").then(function(c){c.wait(function(c){clientShortcuts.get("serverRequests").then(function(a){a.send("ivopetkov-users-login",{provider:b,location:window.location.toString()}).then(function(a){a=JSON.parse(a);"1"===a.status&&(d=!0,"undefined"!==typeof a.jsCode&&
(new Function(a.jsCode))(),"undefined"!==typeof a.redirectUrl?window.location=a.redirectUrl:(html5DOMDocument.insert(a.badgeHTML),c.close()))})})})})},logout:function(){clientShortcuts.get("lightbox").then(function(b){b.wait(function(b){clientShortcuts.get("serverRequests").then(function(c){c.send("ivopetkov-users-logout").then(function(a){"1"===JSON.parse(a).status&&(d=!1,(a=document.querySelector(".ivopetkov-users-badge"))&&a.parentNode.removeChild(a),b.close())})})})})},openLogin:function(){clientShortcuts.get("lightbox").then(function(b){b.wait(function(b){clientShortcuts.get("serverRequests").then(function(c){c.send("ivopetkov-users-login-screen").then(function(a){a=
JSON.parse(a);"undefined"!==typeof a.html&&b.open(a.html)})})})})},openSettings:function(){clientShortcuts.get("lightbox").then(function(b){b.wait(function(b){clientShortcuts.get("serverRequests").then(function(c){c.send("ivopetkov-users-settings-window").then(function(a){a=JSON.parse(a);"undefined"!==typeof a.html&&b.open(a.html)})})})})},openPreview:function(b,c){"undefined"!==typeof b&&"undefined"!==typeof c&&clientShortcuts.get("lightbox").then(function(d){d.wait(function(a){var d={provider:b,
id:c};clientShortcuts.get("serverRequests").then(function(b){b.send("ivopetkov-users-preview-window",d).then(function(b){b=JSON.parse(b);"undefined"!==typeof b.html&&a.open(b.html)})["catch"](function(){a.close()})})})})}}}();